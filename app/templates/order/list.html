{% extends "base.html" %}

{% block title %}Замовлення{% endblock %}



{% block content %}
    <div class="row">
        <h1>Замовлення</h1>
        <div class="col">
            <a href="{{ url_for('order.add_order') }}" class="btn btn-primary mb-3"> <i class="bi bi-plus-circle"></i> Додати нове</a>
        </div>
    </div>

    <div class="row">


        <table class="table">
            <colgroup>
                <col style="width: 5%">
                <col style="width: 10%">
                <col style="width: 55%">
                <col style="width: 10%">
                <col style="width: 10%">
                <col style="width: 10%">
            </colgroup>
            <thead>
            <tr>
                <th>ID</th>
                <th>Дата</th>
                <th>Товари</th>
                <th>Загальна вартість</th>
                <th>Загальна маржа</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th></th>
                <th></th>
                <th>
                    <table class="table table-sm table-borderless mb-0">
                        <colgroup>
                            <col style="width: 50%">
                            <col style="width: 10%">
                            <col style="width: 20%">
                            <col style="width: 20%">
                        </colgroup>
                        <tr>
                            <td>Назва</td>
                            <td>К-сть</td>
                            <td>Ціна</td>
                            <td>Маржа (сума)</td>
                        </tr>
                    </table>
                </th>
                <th></th>
                <th></th>
                <th></th>
            </tr>
            {% for order in orders %}
                <tr id="orderRow-{{ order.id }}">
                    <td>{{ order.id }}</td>
                    <td>{{ order.created_at.strftime('%d-%m-%Y %H:%M:%S') }}</td>
                    <td>
                        <table class="table table-sm table-borderless mb-0">
                            <colgroup>
                                <col style="width: 50%">
                                <col style="width: 10%">
                                <col style="width: 20%">
                                <col style="width: 20%">
                            </colgroup>
                            {% for item in order.items %}
                                <tr>
                                    <td>{{ item.product.name }}</td>
                                    <td>x{{ item.quantity }}</td>
                                    <td>{{ '%.2f' | format(item.unit_price * item.quantity) }} </td>
                                    <td>{{ '%.2f' | format(item.product.margin * item.quantity) }} </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </td>
                    <td>{{ '%.2f' | format(order.total) }} </td>
                    <td>{{ '%.2f' | format(order.total_margin) }} </td>
                    <td>
                        <a href="{{ url_for('order.edit_order', order_id=order.id) }}"
                           class="btn btn-sm btn-warning">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <a onclick="deleteOrder({{ order.id }})" class="btn btn-sm btn-danger">
                            <i class="bi bi-trash"></i>
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/order/order_list.js') }}"></script>
{% endblock %}